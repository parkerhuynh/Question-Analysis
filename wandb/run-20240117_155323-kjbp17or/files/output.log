sample number: 96169
output_dim: 8
token_size: 7057
ans_type_to_idx: {'yes/no': 0, 'action': 1, 'object': 2, 'location': 3, 'other': 4, 'color': 5, 'human': 6, 'number': 7}
sample number: 18473
output_dim: 8
token_size: 7057
ans_type_to_idx: {'yes/no': 0, 'action': 1, 'object': 2, 'location': 3, 'other': 4, 'color': 5, 'human': 6, 'number': 7}
FullyShardedDataParallel(
  (_fsdp_wrapped_module): FlattenParamsWrapper(
    (_fpw_module): Net(
      (word_embeddings): FullyShardedDataParallel(
        (_fsdp_wrapped_module): FlattenParamsWrapper(
          (_fpw_module): Embedding(7057, 300)
        )
      )
      (question_encoder): QuestionEmbedding(
        (gru): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): GRU(300, 1024, batch_first=True)
          )
        )
        (fc): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1024, bias=True)
          )
        )
      )
      (qt_header): Sequential(
        (0): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1000, bias=True)
          )
        )
        (1): Dropout(p=0.5, inplace=False)
        (2): Tanh()
        (3): Linear(in_features=1000, out_features=8, bias=True)
      )
    )
  )
)
Train Epoch: 1 	Loss: 1.759841
Test set: Average loss: 1.7203, Accuracy: 5042/18474 (27.29%)
Train Epoch: 2 	Loss: 1.683907
Test set: Average loss: 1.7224, Accuracy: 5116/18474 (27.69%)
Train Epoch: 3 	Loss: 1.679167
Test set: Average loss: 1.6952, Accuracy: 6247/18474 (33.82%)
Train Epoch: 4 	Loss: 1.424904
Test set: Average loss: 1.0247, Accuracy: 11626/18474 (62.93%)
Train Epoch: 5 	Loss: 0.787758
Test set: Average loss: 0.6663, Accuracy: 14880/18474 (80.55%)
Train Epoch: 6 	Loss: 0.524286
Test set: Average loss: 0.5274, Accuracy: 16461/18474 (89.10%)
Train Epoch: 7 	Loss: 0.418051
Test set: Average loss: 0.4709, Accuracy: 16586/18474 (89.78%)
Train Epoch: 8 	Loss: 0.376068
Test set: Average loss: 0.4397, Accuracy: 16617/18474 (89.95%)
Train Epoch: 9 	Loss: 0.348460
Test set: Average loss: 0.4288, Accuracy: 16622/18474 (89.98%)
Train Epoch: 10 	Loss: 0.332342
Test set: Average loss: 0.4280, Accuracy: 16672/18474 (90.25%)
Train Epoch: 11 	Loss: 0.316902
Test set: Average loss: 0.4083, Accuracy: 16688/18474 (90.33%)
Train Epoch: 12 	Loss: 0.305933
Test set: Average loss: 0.4050, Accuracy: 16698/18474 (90.39%)
Train Epoch: 13 	Loss: 0.300151
Test set: Average loss: 0.4030, Accuracy: 16719/18474 (90.50%)
Train Epoch: 14 	Loss: 0.290354
Test set: Average loss: 0.3854, Accuracy: 16726/18474 (90.54%)
Train Epoch: 15 	Loss: 0.287073
Test set: Average loss: 0.3820, Accuracy: 16742/18474 (90.62%)
Train Epoch: 16 	Loss: 0.278392
Test set: Average loss: 0.3704, Accuracy: 16756/18474 (90.70%)
Train Epoch: 17 	Loss: 0.272372
Test set: Average loss: 0.3747, Accuracy: 16760/18474 (90.72%)
Train Epoch: 18 	Loss: 0.268969
Test set: Average loss: 0.3654, Accuracy: 16799/18474 (90.93%)
Train Epoch: 19 	Loss: 0.269506
Test set: Average loss: 0.3628, Accuracy: 16793/18474 (90.90%)
Train Epoch: 20 	Loss: 0.265024
Test set: Average loss: 0.3687, Accuracy: 16811/18474 (91.00%)
Train Epoch: 21 	Loss: 0.260158
Test set: Average loss: 0.3538, Accuracy: 16871/18474 (91.32%)
Train Epoch: 22 	Loss: 0.255298
Test set: Average loss: 0.3665, Accuracy: 16879/18474 (91.37%)
Train Epoch: 23 	Loss: 0.255903
Test set: Average loss: 0.3575, Accuracy: 16868/18474 (91.31%)
Train Epoch: 24 	Loss: 0.251928
Test set: Average loss: 0.3612, Accuracy: 16890/18474 (91.43%)
Train Epoch: 25 	Loss: 0.248815
Test set: Average loss: 0.3529, Accuracy: 16910/18474 (91.53%)
Train Epoch: 26 	Loss: 0.245749
Test set: Average loss: 0.3512, Accuracy: 16927/18474 (91.63%)
Train Epoch: 27 	Loss: 0.246303
Test set: Average loss: 0.3604, Accuracy: 16935/18474 (91.67%)
Train Epoch: 28 	Loss: 0.247234
Test set: Average loss: 0.3472, Accuracy: 16933/18474 (91.66%)
Train Epoch: 29 	Loss: 0.245024
Test set: Average loss: 0.3443, Accuracy: 16961/18474 (91.81%)
Train Epoch: 30 	Loss: 0.241359
Test set: Average loss: 0.3441, Accuracy: 16962/18474 (91.82%)
Train Epoch: 31 	Loss: 0.239142
Test set: Average loss: 0.3529, Accuracy: 16964/18474 (91.83%)
Train Epoch: 32 	Loss: 0.234781
Test set: Average loss: 0.3530, Accuracy: 16988/18474 (91.96%)
Train Epoch: 33 	Loss: 0.231142
Test set: Average loss: 0.3472, Accuracy: 16978/18474 (91.90%)
Train Epoch: 34 	Loss: 0.235854
Test set: Average loss: 0.3368, Accuracy: 17019/18474 (92.12%)
Train Epoch: 35 	Loss: 0.228962
Test set: Average loss: 0.3584, Accuracy: 17007/18474 (92.06%)
Train Epoch: 36 	Loss: 0.229995
Test set: Average loss: 0.3442, Accuracy: 17031/18474 (92.19%)
Train Epoch: 37 	Loss: 0.230828
Test set: Average loss: 0.3623, Accuracy: 16971/18474 (91.86%)
Train Epoch: 38 	Loss: 0.227224
Test set: Average loss: 0.3456, Accuracy: 17014/18474 (92.10%)
Train Epoch: 39 	Loss: 0.223862
Test set: Average loss: 0.3275, Accuracy: 17058/18474 (92.34%)
Train Epoch: 40 	Loss: 0.223935
Test set: Average loss: 0.3305, Accuracy: 17047/18474 (92.28%)
Train Epoch: 41 	Loss: 0.224247
Test set: Average loss: 0.3463, Accuracy: 17055/18474 (92.32%)
Train Epoch: 42 	Loss: 0.221331
Test set: Average loss: 0.3581, Accuracy: 17025/18474 (92.16%)
Train Epoch: 43 	Loss: 0.219766
Test set: Average loss: 0.3260, Accuracy: 17056/18474 (92.32%)
Train Epoch: 44 	Loss: 0.222669
Test set: Average loss: 0.3347, Accuracy: 17038/18474 (92.23%)
Train Epoch: 45 	Loss: 0.218588
Test set: Average loss: 0.3243, Accuracy: 17082/18474 (92.47%)
Train Epoch: 46 	Loss: 0.216688
Test set: Average loss: 0.3356, Accuracy: 17083/18474 (92.47%)
Train Epoch: 47 	Loss: 0.216697
Test set: Average loss: 0.3250, Accuracy: 17076/18474 (92.43%)
Train Epoch: 48 	Loss: 0.217966
Test set: Average loss: 0.3281, Accuracy: 17097/18474 (92.55%)
Train Epoch: 49 	Loss: 0.212098
Test set: Average loss: 0.3449, Accuracy: 17096/18474 (92.54%)
Train Epoch: 50 	Loss: 0.210921
Test set: Average loss: 0.3378, Accuracy: 17076/18474 (92.43%)
CUDA event elapsed time: 1774.150875sec
FullyShardedDataParallel(
  (_fsdp_wrapped_module): FlattenParamsWrapper(
    (_fpw_module): Net(
      (word_embeddings): FullyShardedDataParallel(
        (_fsdp_wrapped_module): FlattenParamsWrapper(
          (_fpw_module): Embedding(7057, 300)
        )
      )
      (question_encoder): QuestionEmbedding(
        (gru): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): GRU(300, 1024, batch_first=True)
          )
        )
        (fc): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1024, bias=True)
          )
        )
      )
      (qt_header): Sequential(
        (0): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1000, bias=True)
          )
        )
        (1): Dropout(p=0.5, inplace=False)
        (2): Tanh()
        (3): Linear(in_features=1000, out_features=8, bias=True)
      )
    )
  )
)