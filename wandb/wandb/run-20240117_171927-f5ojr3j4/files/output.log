sample number: 96169
output_dim: 8
token_size: 7057
ans_type_to_idx: {'yes/no': 0, 'action': 1, 'object': 2, 'location': 3, 'other': 4, 'color': 5, 'human': 6, 'number': 7}
sample number: 18473
output_dim: 8
token_size: 7057
ans_type_to_idx: {'yes/no': 0, 'action': 1, 'object': 2, 'location': 3, 'other': 4, 'color': 5, 'human': 6, 'number': 7}
[[ 0.48409   0.33505   0.42066  ... -1.7047   -0.62474   0.69989 ]
 [ 0.14354   0.057574  0.070036 ... -0.057567 -0.037463  0.060437]
 [-7.1395   -2.4339   -2.5181   ... -4.8147   -5.1779    6.7697  ]
 ...
 [ 3.9665   -0.4368   -4.9797   ...  1.2008   -2.9568    2.8831  ]
 [-1.0742    0.28313  -1.0317   ...  2.0254   -1.347     0.38743 ]
 [ 1.2023   -1.0608   -0.7661   ...  2.0222    2.6343    3.7644  ]]
FullyShardedDataParallel(
  (_fsdp_wrapped_module): FlattenParamsWrapper(
    (_fpw_module): Net(
      (word_embeddings): FullyShardedDataParallel(
        (_fsdp_wrapped_module): FlattenParamsWrapper(
          (_fpw_module): Embedding(7057, 300)
        )
      )
      (question_encoder): QuestionEmbedding(
        (gru): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): GRU(300, 1024, batch_first=True)
          )
        )
        (fc): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1024, bias=True)
          )
        )
      )
      (qt_header): Sequential(
        (0): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1000, bias=True)
          )
        )
        (1): Dropout(p=0.5, inplace=False)
        (2): Tanh()
        (3): Linear(in_features=1000, out_features=8, bias=True)
      )
    )
  )
)
Train Epoch: 1 	Loss: 1.761718
Test set: Average loss: 1.7171, Accuracy: 4976/18474 (26.94%)
Train Epoch: 2 	Loss: 1.681186
Test set: Average loss: 1.6850, Accuracy: 8973/18474 (48.57%)
Train Epoch: 3 	Loss: 1.311998
Test set: Average loss: 0.8827, Accuracy: 13525/18474 (73.21%)
Train Epoch: 4 	Loss: 0.616549
Test set: Average loss: 0.4939, Accuracy: 16195/18474 (87.66%)
Train Epoch: 5 	Loss: 0.398877
Test set: Average loss: 0.3869, Accuracy: 16587/18474 (89.79%)
Train Epoch: 6 	Loss: 0.324404
Test set: Average loss: 0.3478, Accuracy: 16716/18474 (90.48%)
Train Epoch: 7 	Loss: 0.293130
Test set: Average loss: 0.3261, Accuracy: 16796/18474 (90.92%)
Train Epoch: 8 	Loss: 0.270606
Test set: Average loss: 0.3039, Accuracy: 16874/18474 (91.34%)
Train Epoch: 9 	Loss: 0.259582
Test set: Average loss: 0.2934, Accuracy: 16920/18474 (91.59%)
Train Epoch: 10 	Loss: 0.241871
Test set: Average loss: 0.2825, Accuracy: 16994/18474 (91.99%)
Train Epoch: 11 	Loss: 0.233951
Test set: Average loss: 0.2777, Accuracy: 17061/18474 (92.35%)
Train Epoch: 12 	Loss: 0.228319
Test set: Average loss: 0.2691, Accuracy: 17083/18474 (92.47%)
Train Epoch: 13 	Loss: 0.221090
Test set: Average loss: 0.2673, Accuracy: 17109/18474 (92.61%)
Train Epoch: 14 	Loss: 0.215252
Test set: Average loss: 0.2618, Accuracy: 17141/18474 (92.78%)
Train Epoch: 15 	Loss: 0.208058
Test set: Average loss: 0.2659, Accuracy: 17151/18474 (92.84%)
Train Epoch: 16 	Loss: 0.202762
Test set: Average loss: 0.2583, Accuracy: 17175/18474 (92.97%)
Train Epoch: 17 	Loss: 0.201300
Test set: Average loss: 0.2533, Accuracy: 17195/18474 (93.08%)
Train Epoch: 18 	Loss: 0.198337
Test set: Average loss: 0.2526, Accuracy: 17219/18474 (93.21%)
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f3cd5c06e50>
Traceback (most recent call last):
  File "/home/ndhuynh/.conda/envs/cartoon/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1481, in __del__
    self._shutdown_workers()
  File "/home/ndhuynh/.conda/envs/cartoon/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1445, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/ndhuynh/.conda/envs/cartoon/lib/python3.9/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/ndhuynh/.conda/envs/cartoon/lib/python3.9/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
  File "/home/ndhuynh/.conda/envs/cartoon/lib/python3.9/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/ndhuynh/.conda/envs/cartoon/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
Process SpawnProcess-1:
Traceback (most recent call last):
  File "/home/ndhuynh/.conda/envs/cartoon/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/home/ndhuynh/.conda/envs/cartoon/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ndhuynh/.conda/envs/cartoon/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 71, in _wrap
    pass  # SIGINT; Killed by parent, do nothing
KeyboardInterrupt