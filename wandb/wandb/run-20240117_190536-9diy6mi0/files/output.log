sample number: 96169
output_dim: 8
token_size: 7057
ans_type_to_idx: {'yes/no': 0, 'action': 1, 'object': 2, 'location': 3, 'other': 4, 'color': 5, 'human': 6, 'number': 7}
sample number: 18473
output_dim: 8
token_size: 7057
ans_type_to_idx: {'yes/no': 0, 'action': 1, 'object': 2, 'location': 3, 'other': 4, 'color': 5, 'human': 6, 'number': 7}
[[ 0.48409   0.33505   0.42066  ... -1.7047   -0.62474   0.69989 ]
 [ 0.14354   0.057574  0.070036 ... -0.057567 -0.037463  0.060437]
 [-7.1395   -2.4339   -2.5181   ... -4.8147   -5.1779    6.7697  ]
 ...
 [ 3.9665   -0.4368   -4.9797   ...  1.2008   -2.9568    2.8831  ]
 [-1.0742    0.28313  -1.0317   ...  2.0254   -1.347     0.38743 ]
 [ 1.2023   -1.0608   -0.7661   ...  2.0222    2.6343    3.7644  ]]
FullyShardedDataParallel(
  (_fsdp_wrapped_module): FlattenParamsWrapper(
    (_fpw_module): Net(
      (word_embeddings): FullyShardedDataParallel(
        (_fsdp_wrapped_module): FlattenParamsWrapper(
          (_fpw_module): Embedding(7057, 300)
        )
      )
      (question_encoder): QuestionEmbedding(
        (gru): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): GRU(300, 1024, batch_first=True)
          )
        )
        (fc): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1024, bias=True)
          )
        )
      )
      (qt_header): Sequential(
        (0): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1000, bias=True)
          )
        )
        (1): Dropout(p=0.5, inplace=False)
        (2): Tanh()
        (3): Linear(in_features=1000, out_features=8, bias=True)
      )
    )
  )
)
Train Epoch: 1 	Loss: 1.907316
Test set: Average loss: 1.7909, Accuracy: 4749/18474 (25.71%)
Train Epoch: 2 	Loss: 1.729967
Test set: Average loss: 1.7239, Accuracy: 4983/18474 (26.97%)
Train Epoch: 3 	Loss: 1.690115
Test set: Average loss: 1.7160, Accuracy: 4983/18474 (26.97%)
Train Epoch: 4 	Loss: 1.686787
Test set: Average loss: 1.7167, Accuracy: 4760/18474 (25.77%)
Train Epoch: 5 	Loss: 1.686369
Test set: Average loss: 1.7135, Accuracy: 4983/18474 (26.97%)
Train Epoch: 6 	Loss: 1.681016
Test set: Average loss: 1.7103, Accuracy: 6212/18474 (33.63%)
Train Epoch: 7 	Loss: 1.675850
Test set: Average loss: 1.6950, Accuracy: 8710/18474 (47.15%)
Train Epoch: 8 	Loss: 1.646070
Test set: Average loss: 1.6266, Accuracy: 8694/18474 (47.06%)
Train Epoch: 9 	Loss: 1.508708
Test set: Average loss: 1.3848, Accuracy: 8819/18474 (47.74%)
Train Epoch: 10 	Loss: 1.209813
Test set: Average loss: 1.0863, Accuracy: 11645/18474 (63.03%)
Train Epoch: 11 	Loss: 0.972735
Test set: Average loss: 0.8904, Accuracy: 13245/18474 (71.70%)
Train Epoch: 12 	Loss: 0.797020
Test set: Average loss: 0.7165, Accuracy: 14657/18474 (79.34%)
Train Epoch: 13 	Loss: 0.647473
Test set: Average loss: 0.5960, Accuracy: 15379/18474 (83.25%)
Train Epoch: 14 	Loss: 0.540753
Test set: Average loss: 0.5165, Accuracy: 16248/18474 (87.95%)
Train Epoch: 15 	Loss: 0.469448
Test set: Average loss: 0.4632, Accuracy: 16494/18474 (89.28%)
Train Epoch: 16 	Loss: 0.418893
Test set: Average loss: 0.4251, Accuracy: 16588/18474 (89.79%)
Train Epoch: 17 	Loss: 0.385107
Test set: Average loss: 0.4022, Accuracy: 16667/18474 (90.22%)
Train Epoch: 18 	Loss: 0.360533
Test set: Average loss: 0.3826, Accuracy: 16722/18474 (90.52%)
Train Epoch: 19 	Loss: 0.336711
Test set: Average loss: 0.3708, Accuracy: 16723/18474 (90.52%)
Train Epoch: 20 	Loss: 0.326477
Test set: Average loss: 0.3599, Accuracy: 16747/18474 (90.65%)
Train Epoch: 21 	Loss: 0.313370
Test set: Average loss: 0.3487, Accuracy: 16773/18474 (90.79%)
Train Epoch: 22 	Loss: 0.303454
Test set: Average loss: 0.3401, Accuracy: 16792/18474 (90.90%)
Train Epoch: 23 	Loss: 0.295800
Test set: Average loss: 0.3336, Accuracy: 16816/18474 (91.03%)
Train Epoch: 24 	Loss: 0.289501
Test set: Average loss: 0.3266, Accuracy: 16847/18474 (91.19%)
Train Epoch: 25 	Loss: 0.283124
Test set: Average loss: 0.3174, Accuracy: 16886/18474 (91.40%)
Train Epoch: 26 	Loss: 0.272604
Test set: Average loss: 0.3135, Accuracy: 16910/18474 (91.53%)
Train Epoch: 27 	Loss: 0.272120
Test set: Average loss: 0.3053, Accuracy: 16901/18474 (91.49%)
Train Epoch: 28 	Loss: 0.266909
Test set: Average loss: 0.3052, Accuracy: 16919/18474 (91.58%)
Train Epoch: 29 	Loss: 0.258787
Test set: Average loss: 0.2980, Accuracy: 16932/18474 (91.65%)
Train Epoch: 30 	Loss: 0.253849
Test set: Average loss: 0.2937, Accuracy: 16950/18474 (91.75%)
Train Epoch: 31 	Loss: 0.252278
Test set: Average loss: 0.2904, Accuracy: 16976/18474 (91.89%)
Train Epoch: 32 	Loss: 0.245265
Test set: Average loss: 0.2878, Accuracy: 17004/18474 (92.04%)
Train Epoch: 33 	Loss: 0.245436
Test set: Average loss: 0.2838, Accuracy: 16994/18474 (91.99%)
Train Epoch: 34 	Loss: 0.239622
Test set: Average loss: 0.2809, Accuracy: 17019/18474 (92.12%)
Train Epoch: 35 	Loss: 0.236265
Test set: Average loss: 0.2825, Accuracy: 17030/18474 (92.18%)
Train Epoch: 36 	Loss: 0.231739
Test set: Average loss: 0.2772, Accuracy: 17037/18474 (92.22%)
Train Epoch: 37 	Loss: 0.231466
Test set: Average loss: 0.2775, Accuracy: 17044/18474 (92.26%)
Train Epoch: 38 	Loss: 0.227166
Test set: Average loss: 0.2751, Accuracy: 17052/18474 (92.30%)
Train Epoch: 39 	Loss: 0.225700
Test set: Average loss: 0.2725, Accuracy: 17071/18474 (92.41%)
Train Epoch: 40 	Loss: 0.222162
Test set: Average loss: 0.2751, Accuracy: 17084/18474 (92.48%)
Train Epoch: 41 	Loss: 0.219325
Test set: Average loss: 0.2693, Accuracy: 17103/18474 (92.58%)
Train Epoch: 42 	Loss: 0.217688
Test set: Average loss: 0.2709, Accuracy: 17113/18474 (92.63%)
Train Epoch: 43 	Loss: 0.211227
Test set: Average loss: 0.2652, Accuracy: 17136/18474 (92.76%)
Train Epoch: 44 	Loss: 0.212731
Test set: Average loss: 0.2659, Accuracy: 17130/18474 (92.72%)
Train Epoch: 45 	Loss: 0.209834
Test set: Average loss: 0.2637, Accuracy: 17152/18474 (92.84%)
Train Epoch: 46 	Loss: 0.205025
Test set: Average loss: 0.2678, Accuracy: 17163/18474 (92.90%)
Train Epoch: 47 	Loss: 0.208051
Test set: Average loss: 0.2627, Accuracy: 17151/18474 (92.84%)
Train Epoch: 48 	Loss: 0.207783
Test set: Average loss: 0.2604, Accuracy: 17188/18474 (93.04%)
Train Epoch: 49 	Loss: 0.203014
Test set: Average loss: 0.2586, Accuracy: 17186/18474 (93.03%)
Train Epoch: 50 	Loss: 0.201572
Test set: Average loss: 0.2635, Accuracy: 17162/18474 (92.90%)
CUDA event elapsed time: 8704.671sec
FullyShardedDataParallel(
  (_fsdp_wrapped_module): FlattenParamsWrapper(
    (_fpw_module): Net(
      (word_embeddings): FullyShardedDataParallel(
        (_fsdp_wrapped_module): FlattenParamsWrapper(
          (_fpw_module): Embedding(7057, 300)
        )
      )
      (question_encoder): QuestionEmbedding(
        (gru): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): GRU(300, 1024, batch_first=True)
          )
        )
        (fc): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1024, bias=True)
          )
        )
      )
      (qt_header): Sequential(
        (0): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1000, bias=True)
          )
        )
        (1): Dropout(p=0.5, inplace=False)
        (2): Tanh()
        (3): Linear(in_features=1000, out_features=8, bias=True)
      )
    )
  )
)