sample number: 96169
output_dim: 8
token_size: 7057
ans_type_to_idx: {'yes/no': 0, 'action': 1, 'object': 2, 'location': 3, 'other': 4, 'color': 5, 'human': 6, 'number': 7}
sample number: 18473
output_dim: 8
token_size: 7057
ans_type_to_idx: {'yes/no': 0, 'action': 1, 'object': 2, 'location': 3, 'other': 4, 'color': 5, 'human': 6, 'number': 7}
FullyShardedDataParallel(
  (_fsdp_wrapped_module): FlattenParamsWrapper(
    (_fpw_module): Net(
      (word_embeddings): FullyShardedDataParallel(
        (_fsdp_wrapped_module): FlattenParamsWrapper(
          (_fpw_module): Embedding(7057, 300)
        )
      )
      (question_encoder): QuestionEmbedding(
        (lstm): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): LSTM(300, 1024, batch_first=True)
          )
        )
        (fc): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1024, bias=True)
          )
        )
      )
      (qt_header): Sequential(
        (0): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1000, bias=True)
          )
        )
        (1): Dropout(p=0.5, inplace=False)
        (2): Tanh()
        (3): Linear(in_features=1000, out_features=8, bias=True)
      )
    )
  )
)
Train Epoch: 1 	Loss: 1.989188
Test set: Average loss: 1.8882, Accuracy: 4984/18474 (26.98%)
Train Epoch: 2 	Loss: 1.793460
Test set: Average loss: 1.7472, Accuracy: 4984/18474 (26.98%)
Train Epoch: 3 	Loss: 1.702037
Test set: Average loss: 1.7185, Accuracy: 4984/18474 (26.98%)
Train Epoch: 4 	Loss: 1.689742
Test set: Average loss: 1.7171, Accuracy: 4984/18474 (26.98%)
Train Epoch: 5 	Loss: 1.685058
Test set: Average loss: 1.7173, Accuracy: 4985/18474 (26.98%)
Train Epoch: 6 	Loss: 1.684817
Test set: Average loss: 1.7169, Accuracy: 4985/18474 (26.98%)
Train Epoch: 7 	Loss: 1.686889
Test set: Average loss: 1.7164, Accuracy: 4985/18474 (26.98%)
Train Epoch: 8 	Loss: 1.686553
Test set: Average loss: 1.7158, Accuracy: 4985/18474 (26.98%)
Train Epoch: 9 	Loss: 1.687705
Test set: Average loss: 1.7147, Accuracy: 4988/18474 (27.00%)
Train Epoch: 10 	Loss: 1.683375
Test set: Average loss: 1.7157, Accuracy: 4989/18474 (27.01%)
Train Epoch: 11 	Loss: 1.686628
Test set: Average loss: 1.7152, Accuracy: 4987/18474 (26.99%)
Train Epoch: 12 	Loss: 1.684589
Test set: Average loss: 1.7139, Accuracy: 4985/18474 (26.98%)
Train Epoch: 13 	Loss: 1.685561
Test set: Average loss: 1.7153, Accuracy: 4983/18474 (26.97%)
Train Epoch: 14 	Loss: 1.686029
Test set: Average loss: 1.7155, Accuracy: 4992/18474 (27.02%)
Train Epoch: 15 	Loss: 1.686333
Test set: Average loss: 1.7155, Accuracy: 4984/18474 (26.98%)
Train Epoch: 16 	Loss: 1.684070
Test set: Average loss: 1.7144, Accuracy: 5030/18474 (27.23%)
Train Epoch: 17 	Loss: 1.681878
Test set: Average loss: 1.7111, Accuracy: 5038/18474 (27.27%)
Train Epoch: 18 	Loss: 1.677736
Test set: Average loss: 1.7014, Accuracy: 5486/18474 (29.70%)
Train Epoch: 19 	Loss: 1.651938
Test set: Average loss: 1.6401, Accuracy: 8461/18474 (45.80%)
Train Epoch: 20 	Loss: 1.469454
Test set: Average loss: 1.2669, Accuracy: 9314/18474 (50.42%)
Train Epoch: 21 	Loss: 1.075667
Test set: Average loss: 0.9776, Accuracy: 12344/18474 (66.82%)
Train Epoch: 22 	Loss: 0.856888
Test set: Average loss: 0.7997, Accuracy: 14580/18474 (78.92%)
Train Epoch: 23 	Loss: 0.690067
Test set: Average loss: 0.6623, Accuracy: 15152/18474 (82.02%)
Train Epoch: 24 	Loss: 0.564881
Test set: Average loss: 0.5730, Accuracy: 16223/18474 (87.82%)
Train Epoch: 25 	Loss: 0.489980
Test set: Average loss: 0.5213, Accuracy: 16372/18474 (88.62%)
Train Epoch: 26 	Loss: 0.436441
Test set: Average loss: 0.4745, Accuracy: 16450/18474 (89.04%)
Train Epoch: 27 	Loss: 0.401336
Test set: Average loss: 0.4420, Accuracy: 16490/18474 (89.26%)
Train Epoch: 28 	Loss: 0.374294
Test set: Average loss: 0.4168, Accuracy: 16555/18474 (89.61%)
Train Epoch: 29 	Loss: 0.356806
Test set: Average loss: 0.4175, Accuracy: 16598/18474 (89.85%)
Train Epoch: 30 	Loss: 0.343900
Test set: Average loss: 0.4012, Accuracy: 16628/18474 (90.01%)
Train Epoch: 31 	Loss: 0.329045
Test set: Average loss: 0.3912, Accuracy: 16624/18474 (89.99%)
Train Epoch: 32 	Loss: 0.321774
Test set: Average loss: 0.3710, Accuracy: 16653/18474 (90.14%)
Train Epoch: 33 	Loss: 0.314752
Test set: Average loss: 0.3701, Accuracy: 16654/18474 (90.15%)
Train Epoch: 34 	Loss: 0.303486
Test set: Average loss: 0.3648, Accuracy: 16674/18474 (90.26%)
Train Epoch: 35 	Loss: 0.300646
Test set: Average loss: 0.3732, Accuracy: 16667/18474 (90.22%)
Train Epoch: 36 	Loss: 0.300112
Test set: Average loss: 0.3625, Accuracy: 16688/18474 (90.33%)
Train Epoch: 37 	Loss: 0.292760
Test set: Average loss: 0.3531, Accuracy: 16704/18474 (90.42%)
Train Epoch: 38 	Loss: 0.287367
Test set: Average loss: 0.3416, Accuracy: 16741/18474 (90.62%)
Train Epoch: 39 	Loss: 0.287266
Test set: Average loss: 0.3608, Accuracy: 16716/18474 (90.48%)
Train Epoch: 40 	Loss: 0.284517
Test set: Average loss: 0.3459, Accuracy: 16729/18474 (90.55%)
Train Epoch: 41 	Loss: 0.278065
Test set: Average loss: 0.3388, Accuracy: 16768/18474 (90.77%)
Train Epoch: 42 	Loss: 0.274232
Test set: Average loss: 0.3428, Accuracy: 16762/18474 (90.73%)
Train Epoch: 43 	Loss: 0.274698
Test set: Average loss: 0.3484, Accuracy: 16768/18474 (90.77%)
Train Epoch: 44 	Loss: 0.272955
Test set: Average loss: 0.3395, Accuracy: 16795/18474 (90.91%)
Train Epoch: 45 	Loss: 0.269607
Test set: Average loss: 0.3400, Accuracy: 16763/18474 (90.74%)
Train Epoch: 46 	Loss: 0.268579
Test set: Average loss: 0.3416, Accuracy: 16806/18474 (90.97%)
Train Epoch: 47 	Loss: 0.267002
Test set: Average loss: 0.3358, Accuracy: 16799/18474 (90.93%)
Train Epoch: 48 	Loss: 0.264381
Test set: Average loss: 0.3336, Accuracy: 16829/18474 (91.10%)
Train Epoch: 49 	Loss: 0.264785
Test set: Average loss: 0.3245, Accuracy: 16827/18474 (91.08%)
Train Epoch: 50 	Loss: 0.261983
Test set: Average loss: 0.3306, Accuracy: 16820/18474 (91.05%)
CUDA event elapsed time: 8536.321sec
FullyShardedDataParallel(
  (_fsdp_wrapped_module): FlattenParamsWrapper(
    (_fpw_module): Net(
      (word_embeddings): FullyShardedDataParallel(
        (_fsdp_wrapped_module): FlattenParamsWrapper(
          (_fpw_module): Embedding(7057, 300)
        )
      )
      (question_encoder): QuestionEmbedding(
        (lstm): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): LSTM(300, 1024, batch_first=True)
          )
        )
        (fc): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1024, bias=True)
          )
        )
      )
      (qt_header): Sequential(
        (0): FullyShardedDataParallel(
          (_fsdp_wrapped_module): FlattenParamsWrapper(
            (_fpw_module): Linear(in_features=1024, out_features=1000, bias=True)
          )
        )
        (1): Dropout(p=0.5, inplace=False)
        (2): Tanh()
        (3): Linear(in_features=1000, out_features=8, bias=True)
      )
    )
  )
)